<!--
 Copyright (C) 2022 Helmar Hutschenreuter
 
 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU Affero General Public License as
 published by the Free Software Foundation, either version 3 of the
 License, or (at your option) any later version.
 
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.
 
 You should have received a copy of the GNU Affero General Public License
 along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->

<div mat-dialog-title>Filter by {{ column.label }}</div>
<div mat-dialog-content class="fx-column">
  <!-- Search string -->
  <mat-form-field appearance="fill">
    <mat-label>Search</mat-label>
    <input name="search" [(ngModel)]="searchStr" matInput />
  </mat-form-field>

  <!-- Filter selection -->
  <div>
    <ul *ngIf="!filterSelection.isEmpty">
      <!-- Select all checkbox -->
      <li class="fx-row fx-gap-10">
        <mat-checkbox
          name="selectAll"
          [checked]="filterSelection.allSelected"
          [indeterminate]="filterSelection.partlySelected"
          (change)="filterSelection.toggleSelectAll()"
          >Select all search results</mat-checkbox
        >
      </li>

      <!-- Filter option checkboxes -->
      <li
        *ngFor="let filterState of filterSelection.filterOptions"
        class="fx-row fx-gap-10"
      >
        <mat-checkbox
          [checked]="filterState.selected"
          (change)="filterState.toggleSelected()"
        >
          <div class="truncate checkbox-label">
            {{ filterState.text ? filterState.text : "(Empty)" }}
          </div></mat-checkbox
        >
      </li>
    </ul>
    <div *ngIf="filterSelection.isEmpty">No search results found.</div>
  </div>
</div>
<div mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">
    <mat-icon>cancel</mat-icon>
    Cancel
  </button>
  <button mat-button (click)="onRemoveFilter()">
    <mat-icon>filter_alt_off</mat-icon>
    Remove Filter
  </button>
  <button
    mat-raised-button
    color="accent"
    [disabled]="filterSelection.isEmpty || filterSelection.nothingSelected"
    (click)="onApplyFilter()"
  >
    <mat-icon>filter_alt</mat-icon>
    Apply Filter
  </button>
</div>

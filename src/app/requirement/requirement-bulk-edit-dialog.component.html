<!--
 Copyright (C) 2023 Helmar Hutschenreuter
 
 This program is free software: you can redistribute it and/or modify
 it under the terms of the GNU Affero General Public License as
 published by the Free Software Foundation, either version 3 of the
 License, or (at your option) any later version.
 
 This program is distributed in the hope that it will be useful,
 but WITHOUT ANY WARRANTY; without even the implied warranty of
 MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 GNU Affero General Public License for more details.
 
 You should have received a copy of the GNU Affero General Public License
 along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->

<div mat-dialog-title>
  <span>Edit {{ filtered ? "Filtered" : "All" }} Requirements</span>
</div>
<div mat-dialog-content>
  <p>
    By ticking a checkbox, the respective input element is activated. If a value
    is required for the input element, this is indicated by a
    <code>*</code> symbol. Otherwise, the input element can be left empty in
    order to clear existing values.
  </p>
  <form id="bulkEditForm" #form="ngForm" (submit)="onSave(form)">
    <!-- Reference -->
    <div class="fx-row fx-gap-5 fx-center">
      <mat-checkbox
        name="referenceFlag"
        [(ngModel)]="editFlags.reference"
        (change)="onEditFlagChange('reference')"
        class="checkbox"
      ></mat-checkbox>
      <mat-form-field appearance="fill" class="fx-grow">
        <mat-label>Requirement reference</mat-label>
        <input
          name="reference"
          matInput
          [(ngModel)]="patch.reference"
          [disabled]="!editFlags.reference"
        />
      </mat-form-field>
    </div>

    <!-- Summary -->
    <div class="fx-row fx-gap-5 fx-center">
      <mat-checkbox
        name="summaryFlag"
        [(ngModel)]="editFlags.summary"
        (change)="onEditFlagChange('summary')"
        class="checkbox"
      ></mat-checkbox>
      <mat-form-field appearance="fill" class="fx-grow">
        <mat-label>Requirement summary</mat-label>
        <input
          name="summary"
          matInput
          [(ngModel)]="patch.summary"
          [required]="editFlags.summary"
          [disabled]="!editFlags.summary"
        />
      </mat-form-field>
    </div>

    <!-- Description -->
    <div class="fx-row fx-gap-5 fx-center">
      <mat-checkbox
        name="descriptionFlag"
        [(ngModel)]="editFlags.description"
        (change)="onEditFlagChange('description')"
        class="checkbox"
      ></mat-checkbox>
      <mat-form-field appearance="fill" class="fx-grow">
        <mat-label>Requirement description</mat-label>
        <textarea
          name="description"
          matInput
          [(ngModel)]="patch.description"
          [disabled]="!editFlags.description"
        ></textarea>
      </mat-form-field>
    </div>

    <!-- Milestone -->
    <div class="fx-row fx-gap-5 fx-center">
      <mat-checkbox
        name="milestoneFlag"
        [(ngModel)]="editFlags.milestone"
        (change)="onEditFlagChange('milestone')"
        class="checkbox"
      ></mat-checkbox>
      <mat-form-field appearance="fill" class="fx-grow">
        <mat-label>Requirement milestone</mat-label>
        <input
          name="milestone"
          matInput
          [(ngModel)]="patch.milestone"
          [disabled]="!editFlags.milestone"
        />
      </mat-form-field>
    </div>

    <!-- Target Object -->
    <div class="fx-row fx-gap-5 fx-center">
      <mat-checkbox
        name="targetObjectFlag"
        [(ngModel)]="editFlags.target_object"
        (change)="onEditFlagChange('target_object')"
        class="checkbox"
      ></mat-checkbox>
      <mat-form-field appearance="fill" class="fx-grow">
        <mat-label>Requirement target object</mat-label>
        <input
          name="target_object"
          matInput
          [(ngModel)]="patch.target_object"
          [disabled]="!editFlags.target_object"
        />
      </mat-form-field>
    </div>

    <!-- Compliance Status -->
    <div class="fx-row fx-gap-5 fx-center">
      <mat-checkbox
        name="complianceStatusFlag"
        [(ngModel)]="editFlags.compliance_status"
        (change)="onEditFlagChange('compliance_status')"
        class="checkbox"
      ></mat-checkbox>
      <mat-form-field appearance="fill" class="fx-grow">
        <mat-label>Requirement compliance status</mat-label>
        <mat-select
          name="compliance_status"
          [(ngModel)]="patch.compliance_status"
          [disabled]="!editFlags.compliance_status"
        >
          <!-- Add mat-option elements here as per your requirements -->
        </mat-select>
      </mat-form-field>
    </div>

    <!-- Compliance Comment -->
    <div class="fx-row fx-gap-5 fx-center">
      <mat-checkbox
        name="complianceCommentFlag"
        [(ngModel)]="editFlags.compliance_comment"
        (change)="onEditFlagChange('compliance_comment')"
        class="checkbox"
      ></mat-checkbox>
      <mat-form-field appearance="fill" class="fx-grow">
        <mat-label>Requirement compliance comment</mat-label>
        <textarea
          name="compliance_comment"
          matInput
          [(ngModel)]="patch.compliance_comment"
          [disabled]="!editFlags.compliance_comment"
        ></textarea>
      </mat-form-field>
    </div>
  </form>
</div>
<div mat-dialog-actions align="end">
  <button mat-button (click)="onCancel()">
    <mat-icon>cancel</mat-icon>
    Cancel
  </button>
  <button
    mat-raised-button
    color="accent"
    [disabled]="form.invalid || isPatchEmpty"
    type="submit"
    form="bulkEditForm"
  >
    <mat-icon>save</mat-icon>
    <span>&nbsp;</span>
    Save
  </button>
</div>
